(function($){$(document).on("click",".load",function(event){var request={option:"com_mapnavigator",categories:"["+$(this).data("category")+"]",format:"json"};$.ajax({type:"POST",data:request,format:"json",success:function(response){deleteMarkers();var markers=eval("("+response+")");console.log(markers);for(var key in markers){if(markers.hasOwnProperty(key)){var Latlng=new google.maps.LatLng(markers[key].lat,markers[key].lng);addMarker(Latlng,key)}}}});return false})})(jQuery);jQuery(function(b){var a=document.createElement("script");a.src="http://maps.googleapis.com/maps/api/js?sensor=false&callback=initialize";document.body.appendChild(a)});var map;var markers=[];function initialize(){var a={zoom:2,center:new google.maps.LatLng(0,0),mapTypeId:"roadmap"};map=new google.maps.Map(document.getElementById("map-canvas"),a);var b=[{featureType:"all",stylers:[{visibility:"off"}]},{featureType:"landscape",stylers:[{visibility:"on"},{color:"#999"}]},{featureType:"water",stylers:[{visibility:"on"},{color:"#ffffff"}]}];map.setOptions({styles:b})}function addMarker(b,c){var a=new google.maps.Marker({position:b,map:map,title:c,icon:{path:google.maps.SymbolPath.CIRCLE,scale:2,fillColor:"#8a2b87",fillOpacity:1,strokeColor:"#8a2b87",strokeWeight:2}});markers.push(a)}function setAllMap(b){for(var a=0;a<markers.length;a++){markers[a].setMap(b)}}function clearMarkers(){setAllMap(null)}function showMarkers(){setAllMap(map)}function deleteMarkers(){setAllMap(null);markers=[]}google.maps.event.addDomListener(window,"load",initialize);