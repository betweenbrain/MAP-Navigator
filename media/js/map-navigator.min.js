function loadScript(){var a=document.createElement("script");a.type="text/javascript";a.src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false&callback=initialize";document.body.appendChild(a)}window.onload=loadScript;var bounds,infoWnd,map;var markers=[];function initialize(){infoWnd=new google.maps.InfoWindow();var a={zoom:2,center:new google.maps.LatLng(0,0),mapTypeId:"roadmap"};map=new google.maps.Map(document.getElementById("map-canvas"),a);var b=[{featureType:"all",stylers:[{visibility:"off"}]},{featureType:"landscape",stylers:[{visibility:"on"},{color:"#999"}]},{featureType:"water",stylers:[{visibility:"on"},{color:"#ffffff"}]}];map.setOptions({styles:b})}function addMarker(b,e,d,c){var a=new google.maps.Marker({position:b,map:map,title:e,icon:"images/"+c+".png"});bounds.extend(b);google.maps.event.addListener(a,"mouseover",function(){a.setIcon("images/"+c+"-hover.png")});google.maps.event.addListener(a,"mouseout",function(){a.setIcon("images/"+c+".png")});google.maps.event.addListener(a,"click",function(){infoWnd.setContent(e+'<img src="images/'+c+'.png"/>');infoWnd.open(map,a)});if(markers[e]!==e){createSidebarElement(a,d)}markers[e]=e;markers.push(a);map.fitBounds(bounds)}function createSidebarElement(b,d){var c=document.getElementById("sidebar");var a=document.createElement("li");var e=b.getTitle();a.innerHTML='<a id="'+b.__gm_id+'" class="toggle">'+e+'</a><div class="hidden" style="display: none">'+d+"</div>";c.appendChild(a);google.maps.event.addDomListener(a,"click",function(){google.maps.event.trigger(b,"click")});google.maps.event.addDomListener(a,"mouseover",function(){for(var f=0;f<markers.length;f++){if(markers[f].title===e){google.maps.event.trigger(markers[f],"mouseover")}}});google.maps.event.addDomListener(a,"mouseout",function(){for(var f=0;f<markers.length;f++){if(markers[f].title===e){google.maps.event.trigger(markers[f],"mouseout")}}})}function removeSidebarElements(){var a=document.getElementById("sidebar");while(a.firstChild){a.removeChild(a.firstChild)}}function setAllMap(b){for(var a=0;a<markers.length;a++){markers[a].setMap(b)}}function clearMarkers(){setAllMap(null)}function showMarkers(){setAllMap(map)}function deleteMarkers(){setAllMap(null);markers=[]}(function($){$(document).on("click","a.toggle",function(){$(this).next(".hidden").toggle(function(){$(".hidden:visible").not(this).hide()})});$(window).bind("load",function(){setTimeout(function(){$("input:checkbox:first").trigger("click");var request={option:"com_mapnavigator",format:"json","categories[]":$("input:checkbox:first").val(),location:$("input:radio:checked").val()};loadMarkers(request)},1000)});$(document).on("click","form input",function(){var request={option:"com_mapnavigator",format:"json",location:$("input:radio:checked").val()};request.categories=[];$("input.filters:checked").each(function(i){request.categories[i]=$(this).val()});loadMarkers(request)});function loadMarkers(request){bounds=new google.maps.LatLngBounds();$.ajax({type:"POST",data:request,format:"json",success:function(response){deleteMarkers();removeSidebarElements();var markers=eval("("+response+")");for(var key in markers){if(markers.hasOwnProperty(key)){console.log(markers[key].test);if(markers[key].hasOwnProperty("image")){markers[key].info='<img src="'+markers[key].image+'"/>'+markers[key].info}var Latlng=new google.maps.LatLng(markers[key].lat,markers[key].lng);addMarker(Latlng,markers[key].title,markers[key].info,markers[key].type)}}}})}})(jQuery);