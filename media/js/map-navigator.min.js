function loadScript(){var a=document.createElement("script");a.type="text/javascript";a.src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false&callback=initialize";document.body.appendChild(a)}window.onload=loadScript;var artistIcon,artistHoverIcon,audioIcon,audioHoverIcon,blogIcon,blogHoverIcon,eventIcon,eventHoverIcon,resourceIcon,resourceHoverIcon,videoIcon,videoHoverIcon,bounds,element,i,infoWnd,map,markerCluster,dot,dotHover;var markers=[];var mcOptions={styles:[{height:30,width:30,textColor:"#8a2b87",textSize:12,url:"http://media.guggenheim.org/map-navigator/sprite.png",backgroundPosition:"0px -120px"}],zoomOnClick:false,maxZoom:18};var globalStyles=[{featureType:"all",stylers:[{visibility:"off"}]},{featureType:"water",stylers:[{visibility:"on"},{color:"#ffffff"}]},{featureType:"administrative.country",elementType:"labels.text.fill",stylers:[{visibility:"simplifed"},{color:"#888888"},{weight:1}]},{featureType:"administrative.locality",elementType:"labels.text.fill",stylers:[{visibility:"simplifed"},{color:"#888888"},{weight:1}]}];var cityStyles=[{featureType:"all",stylers:[{visibility:"off"}]},{featureType:"water",stylers:[{visibility:"on"},{color:"#ffffff"}]},{featureType:"administrative.country",elementType:"labels.text.fill",stylers:[{visibility:"simplifed"},{color:"#888888"},{weight:1}]},{featureType:"administrative.locality",elementType:"labels.text.fill",stylers:[{visibility:"simplifed"},{color:"#888888"},{weight:1}]},{featureType:"road.arterial",stylers:[{visibility:"on"}]},{featureType:"road.local",stylers:[{visibility:"on"}]},{featureType:"poi.attraction",stylers:[{visibility:"on"}]}];function initialize(){infoWnd=new google.maps.InfoWindow();var a={zoom:2,minZoom:2,center:new google.maps.LatLng(0,0),mapTypeId:"roadmap",disableDefaultUI:true};map=new google.maps.Map(document.getElementById("map-canvas"),a);dot={path:google.maps.SymbolPath.CIRCLE,scale:2,fillColor:"#8a2b87",fillOpacity:1,strokeColor:"#8a2b87",strokeWeight:2};dotHover={path:google.maps.SymbolPath.CIRCLE,scale:2,fillColor:"#ff0000",fillOpacity:1,strokeColor:"#ff0000",strokeWeight:2};artistIcon={url:"http://media.guggenheim.org/map-navigator/sprite.png",size:new google.maps.Size(26,26),origin:new google.maps.Point(33,153),anchor:new google.maps.Point(13,13)};artistHoverIcon={url:"http://media.guggenheim.org/map-navigator/sprite.png",size:new google.maps.Size(26,26),origin:new google.maps.Point(63,153),anchor:new google.maps.Point(13,13)};audioIcon={url:"http://media.guggenheim.org/map-navigator/sprite.png",size:new google.maps.Size(26,26),origin:new google.maps.Point(483,153),anchor:new google.maps.Point(13,13)};audioHoverIcon={url:"http://media.guggenheim.org/map-navigator/sprite.png",size:new google.maps.Size(26,26),origin:new google.maps.Point(513,153),anchor:new google.maps.Point(13,13)};blogIcon={url:"http://media.guggenheim.org/map-navigator/sprite.png",size:new google.maps.Size(26,26),origin:new google.maps.Point(123,153),anchor:new google.maps.Point(13,13)};blogHoverIcon={url:"http://media.guggenheim.org/map-navigator/sprite.png",size:new google.maps.Size(26,26),origin:new google.maps.Point(153,153),anchor:new google.maps.Point(13,13)};eventIcon={url:"http://media.guggenheim.org/map-navigator/sprite.png",size:new google.maps.Size(26,26),origin:new google.maps.Point(212,153),anchor:new google.maps.Point(13,13)};eventHoverIcon={url:"http://media.guggenheim.org/map-navigator/sprite.png",size:new google.maps.Size(26,26),origin:new google.maps.Point(242,153),anchor:new google.maps.Point(13,13)};resourceIcon={url:"http://media.guggenheim.org/map-navigator/sprite.png",size:new google.maps.Size(26,26),origin:new google.maps.Point(392,153),anchor:new google.maps.Point(13,13)};resourceHoverIcon={url:"http://media.guggenheim.org/map-navigator/sprite.png",size:new google.maps.Size(26,26),origin:new google.maps.Point(422,153),anchor:new google.maps.Point(13,13)};videoIcon={url:"http://media.guggenheim.org/map-navigator/sprite.png",size:new google.maps.Size(26,26),origin:new google.maps.Point(302,153),anchor:new google.maps.Point(13,13)};videoHoverIcon={url:"http://media.guggenheim.org/map-navigator/sprite.png",size:new google.maps.Size(26,26),origin:new google.maps.Point(332,153),anchor:new google.maps.Point(13,13)};markerCluster=new MarkerClusterer(map,markers,mcOptions);map.setOptions({styles:globalStyles});if(navigator.geolocation){var b=document.getElementById("toolbar");element=document.createElement("label");element.className="my-location";element.title="My Location";element.innerHTML='<input type="button" name="my-location">My Location';b.appendChild(element);element.addEventListener("click",function(c){navigator.geolocation.getCurrentPosition(function(d){initialLocation=new google.maps.LatLng(d.coords.latitude,d.coords.longitude);map.setCenter(initialLocation);if(map.getZoom()<5){map.setZoom(map.getZoom()+1)}});c.preventDefault()});element=document.createElement("label");element.className="zoom-in";element.title="Zoom In";element.innerHTML='<input type="button" name="zoom-in">Zoom In';b.appendChild(element);element.addEventListener("click",function(c){map.setZoom(map.getZoom()+1);c.preventDefault()});element=document.createElement("label");element.className="zoom-out";element.title="Zoom Out";element.innerHTML='<input type="button" name="zoom-out">Zoom Out';b.appendChild(element);element.addEventListener("click",function(c){map.setZoom(map.getZoom()-1);c.preventDefault()})}google.maps.event.addListener(markerCluster,"clusterclick",function(c){map.setCenter(c.getCenter());if(map.getZoom()>12){map.setZoom(map.getZoom()+4)}else{map.setZoom(map.getZoom()+7)}});google.maps.event.addListener(map,"zoom_changed",function(){for(i=0;i<markers.length;i++){if(map.getZoom()<5){markers[i].setIcon(dot)}else{markers[i].setIcon(window[markers[i].category+"Icon"])}}if(map.getZoom()<5){map.setOptions({styles:globalStyles})}else{map.setOptions({styles:cityStyles})}})}function addMarker(b,c){var a=new google.maps.Marker({position:b,map:map,title:c.title,icon:window[c.category+"Icon"],alias:c.alias,category:c.category,type:c.type,text:c.info});bounds.extend(b);google.maps.event.addListener(a,"mouseover",function(){a.setIcon(window[a.category+"HoverIcon"])});google.maps.event.addListener(a,"mouseout",function(){if(map.getZoom()<5){a.setIcon(dot)}else{a.setIcon(window[a.category+"Icon"])}});google.maps.event.addListener(a,"click",function(){map.panTo(a.getPosition());(function(d){d("."+a.alias).prependTo("#sidebar");d("."+a.alias).find(".toggle").toggle(function(){d(".toggle:visible").not(this).hide()})})(jQuery);infoWnd.setContent(a.title+'<img src="http://media.guggenheim.org/map-navigator/'+a.type+'.png"/>');infoWnd.open(map,a)});if(markers[a.title]!==a.title){createSidebarElement(a)}markers[a.title]=a.title;markers.push(a);map.fitBounds(bounds)}function createSidebarElement(b){var c=document.getElementById("sidebar");var a=document.createElement("li");a.className=b.alias+" toggler "+b.category;var d=b.getTitle();a.innerHTML="<a>"+b.title+'</a><div class="toggle" style="display: none">'+b.text+"</div>";c.appendChild(a);google.maps.event.addDomListener(a,"click",function(){google.maps.event.trigger(b,"click");map.setZoom(19)});google.maps.event.addDomListener(a,"mouseover",function(){for(i=0;i<markers.length;i++){if(markers[i].title===d){google.maps.event.trigger(markers[i],"mouseover")}}});google.maps.event.addDomListener(a,"mouseout",function(){for(i=0;i<markers.length;i++){if(markers[i].title===d){google.maps.event.trigger(markers[i],"mouseout")}}})}(function($){$(window).bind("load",function(){setTimeout(function(){$("input:checkbox:first").trigger("click");var request={option:"com_mapnavigator",format:"json","categories[]":$("input:checkbox:first").val(),location:$("input:radio:checked").val()};loadMarkers(request)},1500)});$(document).on("click","form input",function(){var request={option:"com_mapnavigator",format:"json",location:$("input[name=location]:checked").val(),region:$("input[name=region]:checked").val()};request.categories=[];$("input.filters:checked").each(function(i){request.categories[i]=$(this).val()});loadMarkers(request)});function loadMarkers(request){bounds=new google.maps.LatLngBounds();$.ajax({type:"POST",data:request,format:"json",success:function(response){if(response.length>4){markerCluster.clearMarkers();for(i=0;i<markers.length;i++){markers[i].setMap(null)}markers=[];var sidebar=document.getElementById("sidebar");while(sidebar.firstChild){sidebar.removeChild(sidebar.firstChild)}var locations=eval("("+response+")");for(var key in locations){if(locations.hasOwnProperty(key)){if(locations[key].hasOwnProperty("image")){locations[key].info='<img src="'+locations[key].image+'"/>'+locations[key].info}var location=new google.maps.LatLng(locations[key].lat,locations[key].lng);addMarker(location,locations[key])}}markerCluster.addMarkers(markers)}}})}$(document).on("change",".toggle-btn-group input[type=radio]",function(){if(this.checked){$('input[name="'+this.name+'"].checked').removeClass("checked");$(this).addClass("checked")}})})(jQuery);